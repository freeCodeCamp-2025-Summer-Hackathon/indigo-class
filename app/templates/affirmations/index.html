{% extends "base.html" %} {% block title %} Affirmations {% endblock %} {% block
content %}
<h1 class="page-title text-bg">Your Affirmations</h1>

<p class="para">Keep words that matter to you here.</p>

<section class="affirm__section--top">
  <a href="{{ url_for('affirmations.add_affirmation') }}" class="affirm__action"
    >Submit an Affirmation</a
  >
</section>

<section>
  <!-- dummy category filtering -->
  <form action="{{ url_for('affirmations.affirmations') }}" method="get">
    <input type="hidden" name="page" value=1>

    <label for="category_select">Select Category:</label>
    <select name="category" id="category_select" onchange="this.form.submit()">
      <option value="">All Categories</option>
      {% for category in categories %}
      <option value="{{ category.name }}"
        {% if request.args.get('category') == category.name %}selected{% endif %}
      >
        {{ category.name }}
      </option>
      {% endfor %}
    </select>
    <noscript><button type="submit">Apply Filter</button></noscript>
  </form>
</section>

{% if all_affirmations.total > 0 %}
<section class="affirms__wrapper">
  {% for affirmation in all_affirmations %}
  <div class="affirm">
    <figure class="affirm__wrapper">
      <div class="affirm__btn--wrapper">
      {% if affirmation.user_id == user.user_id %}
        <a
          href="{{ url_for('affirmations.edit_affirmation', affirmation_id=affirmation.affirmation_id)}}"
          class="affirm__edit"
        >
          Edit <img src="{{ url_for('static', filename='images/pen_white.svg') }}" class="white__pen" alt="pen icon">
        </a>
        <form
          method="POST"
          action="{{ url_for('affirmations.delete_affirmation', affirmation_id=affirmation.affirmation_id) }}"
        >
          <button class="affirm__delete" type="submit">&times;</button>
        </form>
        {% endif %}
      </div>
      <blockquote class="affirm__quote">
        {{ affirmation.affirmation_text }}
      </blockquote>
      <figcaption class="affirm__cats">
        {% for category in affirmation.categories %}
          {{ category.category.name }}
        {% endfor %}
      </figcaption>
    </figure>
    {% if current_user.is_admin() or affirmation.user_id == current_user.user_id %}
    <div class="affirm__btn--wrapper">
      <a
        href="{{ url_for('affirmations.edit_affirmation', affirmation_id=affirmation.affirmation_id)}}"
        class="affirm__edit"
        >Edit
      </a>
      <form
        method="POST"
        action="{{ url_for('affirmations.delete_affirmation', affirmation_id=affirmation.affirmation_id) }}"
      >
        <button class="affirm__delete" type="submit">Delete</button>
      </form>
    </div>
    {% endif %}
  </div>
  {% endfor %}
</section>
{% else %}
<p>No affirmations found.</p>
{% endif %}
<section class="affirm__section--bottom">
  <a href="{{ url_for('affirmations.add_affirmation') }}" class="affirm__action"
    >Add affirmation</a
  >
</section>
{% endblock %}
