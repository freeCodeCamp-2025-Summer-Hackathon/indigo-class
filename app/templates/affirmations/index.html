{% extends "base.html" %} {% block title %} Affirmations {% endblock %} {% block
content %}
<h1 class="page-title text-bg">Your Affirmations</h1>

<p class="para">Keep words that matter to you here.</p>

<section class="affirm__section--top">
  <a href="{{ url_for('affirmations.add_affirmation') }}" class="affirm__action"
    >Submit an Affirmation</a
  >
</section>

<section>
  <!-- dummy category filtering -->
  <form action="{{ url_for('affirmations.affirmations') }}" method="get">
    <input type="hidden" name="page" value=1>

    <label for="category_select">Select Category:</label>
    <select name="category" id="category_select" onchange="this.form.submit()">
      <option value="">All Categories</option>
      {% for category in categories %}
      <option value="{{ category.name }}"
        {% if request.args.get('category') == category.name %}selected{% endif %}
      >
        {{ category.name }}
      </option>
      {% endfor %}
    </select>
    <noscript><button type="submit">Apply Filter</button></noscript>
  </form>
</section>

<section class="affirms__wrapper">
  {% for affirmation in all_affirmations %}
  <div class="affirm">
    <figure class="affirm__wrapper">
      <div class="affirm__btn--wrapper">
      {% if affirmation.user_id == user.user_id %}
        <a
          href="{{ url_for('affirmations.edit_affirmation', affirmation_id=affirmation.affirmation_id)}}"
          class="affirm__edit"
        >
          Edit <img src="{{ url_for('static', filename='images/pen_white.svg') }}" class="white__pen" alt="pen icon">
        </a>
        <form
          method="POST"
          action="{{ url_for('affirmations.delete_affirmation', affirmation_id=affirmation.affirmation_id) }}"
        >
          <button class="affirm__delete" type="submit">&times;</button>
        </form>
        {% endif %}
      </div>
      <blockquote class="affirm__quote">
        {{ affirmation.affirmation_text }}
      </blockquote>
      <figcaption class="affirm__cats">
        {% for category in affirmation.categories %}
          {{ category.category.name }}
        {% endfor %}
      </figcaption>
    </figure>
  </div>
  {% endfor %}
</section>

<section class="pagination">
  <!-- dummy page navigation -->
  <nav>
    {% if all_affirmations.has_prev %}
    <a
      href="{{ url_for('affirmations.affirmations', page=all_affirmations.prev_num, category=request.args.get('category')) }}" class="page prev"
      >&lt;</a
    >
    {% endif %} {% for p_num in all_affirmations.iter_pages() %} {% if p_num %}
    {% if p_num == all_affirmations.page %}
    <strong class="page current">{{ p_num }}</strong>
    {% else %}
    <a
      href="{{ url_for('affirmations.affirmations', page=p_num, category=request.args.get('category')) }}" class="page"
      >{{ p_num }}</a
    >
    {% endif %} {% else %} ... {% endif %} {% endfor %} {% if
    all_affirmations.has_next %}
    <a
      href="{{ url_for('affirmations.affirmations', page=all_affirmations.next_num, category=request.args.get('category')) }}" class="page next"
      >&gt;</a
    >
    {% endif %}
  </nav>
</section>
{% endblock %}
